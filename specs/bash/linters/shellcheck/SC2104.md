ShellCheck: SC2104 – In functions, use `return` instead of `break`.

# SC2104 – ShellCheck Wiki

[See this page on GitHub](https://github.com/koalaman/shellcheck/wiki/SC2104)

[Sitemap](index.html)

## In functions, use `return` instead of `break`.

### Problematic code:

```
#cb1-1foo() {
#cb1-2  if [[ -z $1 ]]
#cb1-3  then
#cb1-4    break
#cb1-5  fi
#cb1-6  echo "Hello $1"
#cb1-7}
```

### Correct code:

```
#cb2-1foo() {
#cb2-2  if [[ -z $1 ]]
#cb2-3  then
#cb2-4    return 1
#cb2-5  fi
#cb2-6  echo "Hello $1"
#cb2-7}
```

### Rationale:

`break` or `continue` are used to abort or continue a loop, and are not the right way to exit a function. Use `return` instead.

### Exceptions:

The `break` or `continue` may be intended for a loop that calls the function:

```
#cb3-1# Rarely valid
#cb3-2foo() { break; echo $?; }
#cb3-3while true; do foo; done
```

This is undefined behavior in POSIX sh. Different shells do different things.

When the function is called from a loop:

- `ksh` keeps going and `$?` is 0.
- `bash` version 4.4+ prints an error "break: only meaningful in a `for', `while', or `until' loop", the function keeps going, and `$?` is 0.
- `bash` versions before 4.4, will return from the function, break the loop calling the function, or exit a subshell if there's one in between.
- `dash`, BusyBox `ash`: like above.

When the function is not called from a loop:

- All `bash` versions print an error "break: only meaningful in a `for', `while', or `until' loop", the function keeps going, and `$?` is 0.
- `ksh`, `dash` and `ash` silently keep going and `$?` is 0.

Due to the many different implementations, many of which are not helpful, it's recommended to use proper flow control. A typical solution is making sure the function `return`s success/failure, and calling `myfunction || break` in the loop.

[ShellCheck](https://www.shellcheck.net) is a static analysis tool for shell scripts. This page is part of its documentation.

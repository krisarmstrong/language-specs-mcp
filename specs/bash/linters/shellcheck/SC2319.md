ShellCheck: SC2319 – This `$?` refers to a condition, not a command. Assign to a variable to avoid it being overwritten.

# SC2319 – ShellCheck Wiki

[See this page on GitHub](https://github.com/koalaman/shellcheck/wiki/SC2319)

[Sitemap](index.html)

## This `$?` refers to a condition, not a command. Assign to a variable to avoid it being overwritten.

### Problematic code:

```
#cb1-1mycommand
#cb1-2if [ $? -ne 0 ] && [ $? -ne 14 ]
#cb1-3then
#cb1-4  echo "Command failed"
#cb1-5fi
```

or

```
#cb2-1mycommand
#cb2-2[ $? -gt 0 ] && exit $?
```

### Correct code:

```
#cb3-1mycommand
#cb3-2ret=$?
#cb3-3if [ $ret -ne 0 ] && [ $ret -ne 14 ]
#cb3-4then
#cb3-5  echo "Command failed"
#cb3-6fi
```

or

```
#cb4-1mycommand || exit $?
```

### Rationale:

ShellCheck found a `$?` that always refers to a condition like `[ .. ]`, `[[ .. ]]`, or `test`.

This most commonly happens when trying to inspect `$?` before doing something with it, such as inspecting it again or exiting with it, without realizing that any such inspection will also overwrite `$?`.

In the first problematic example, `[ $? -ne 14 ]` will never be true because it only runs after `[ $? -ne 0 ]` has modified $? to be 0. The solution is to assign `$?` from `mycommand` to a variable so that the variable can be inspected repeatedly.

In the second problematic example, `exit $?` will always `exit 0`, because it only runs if `[ $? -gt 0 ]` returns success and sets `$?` to 0. The solution could again be to assign `$?` to a variable first, or (as shown) use `mycommand || exit $?` as there is no condition to overwrite `$?`.

### Exceptions:

None. Note that ShellCheck does not warn if the usage of `$?` after `[ .. ]` is unconditional, as in `[ -d dir ]; return $?`.

### Related resources:

- Help by adding links to BashFAQ, StackOverflow, man pages, POSIX, etc!

[ShellCheck](https://www.shellcheck.net) is a static analysis tool for shell scripts. This page is part of its documentation.

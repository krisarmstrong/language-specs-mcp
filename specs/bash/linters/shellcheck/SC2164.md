ShellCheck: SC2164 – Use `cd ... || exit` in case `cd` fails.

# SC2164 – ShellCheck Wiki

[See this page on GitHub](https://github.com/koalaman/shellcheck/wiki/SC2164)

[Sitemap](index.html)

## Use `cd ... || exit` in case `cd` fails.

### Problematic code:

```
#cb1-1cd generated_files
#cb1-2rm -r *.c
```

```
#cb2-1func(){
#cb2-2  cd foo
#cb2-3  do_something
#cb2-4}
```

### Correct code:

```
#cb3-1cd generated_files || exit
#cb3-2rm -r *.c
```

```
#cb4-1# For functions, you may want to use return:
#cb4-2func(){
#cb4-3  cd foo || return
#cb4-4  do_something
#cb4-5}
```

### Rationale:

`cd` can fail for a variety of reasons: misspelled paths, missing directories, missing permissions, broken symlinks and more.

If/when it does, the script will keep going and do all its operations in the wrong directory. This can be messy, especially if the operations involve creating or deleting a lot of files.

To avoid this, make sure you handle the cases when `cd` fails. Ways to do this include

- `cd foo || exit` as suggested to abort immediately, using exit code from failed `cd` command
- `cd foo || { echo "Failure"; exit 1; }` abort with custom message
- `cd foo || ! echo "Failure"` omitting "abort with custom message"
- `if cd foo; then echo "Ok"; else echo "Fail"; fi` for custom handling
- `<(cd foo && cmd)` as an alternative to `<(cd foo || exit; cmd)` in `<(..)`, `$(..)` or `( )`

### Exceptions:

ShellCheck does not give this warning when `cd` is on the left of a `||` or `&&`, or the condition of a `if`, `while` or `until` loop. Having a `set -e` command anywhere in the script will disable this message, even though it won't necessarily prevent the issue.

If you are accounting for `cd` failures in a way shellcheck doesn't realize, you can disable this message with a [directive](directive).

[ShellCheck](https://www.shellcheck.net) is a static analysis tool for shell scripts. This page is part of its documentation.

ShellCheck: SC2302 – This loops over values. To loop over keys, use `"${!array[@]}"`.

# SC2302 – ShellCheck Wiki

[See this page on GitHub](https://github.com/koalaman/shellcheck/wiki/SC2302)

[Sitemap](index.html)

## This loops over values. To loop over keys, use `"${!array[@]}"`.

Plus companion warning [SC2303](SC2303): `i is an array value, not a key. Use directly or loop over keys instead.`

### Problematic code:

```
#cb1-1array=(foo bar)
#cb1-2for v in "${array[@]}"
#cb1-3do
#cb1-4  echo "Value is ${array[$v]}"
#cb1-5done
```

### Correct code:

Either loop over values

```
#cb2-1for v in "${array[@]}"
#cb2-2do
#cb2-3  echo "Value is $v"
#cb2-4done
```

or loop over keys:

```
#cb3-1for k in "${!array[@]}"  # Note `!`
#cb3-2do
#cb3-3  echo "Key is $k"
#cb3-4  echo "Value is ${array[$k]}"
#cb3-5done
```

### Rationale:

ShellCheck found a `for` loop over array values, where the variable is used as an array key.

In the problematic example, the loop will print `Value is foo` twice. On the second iteration, `v=bar`, and `bar` is unset and considered zero, so `${array[$v]}` becomes `${array[bar]}` becomes `${array[0]}` becomes `foo`.

If you don't care about the key, simply loop over array values and use `$v` to refer to the array value, like in the first correct example.

If you do want the key, loop over array keys with `"${!array[@]}"`, use `$k` to refer to the array key, and `${array[$k]}` to refer to the array value.

### Exceptions:

If you do want to use values from the arrays as keys in the same array, you can [ignore](ignore) these messages with a directive:

```
#cb4-1declare -A fatherOf=(
#cb4-2  ["Eric Bloodaxe"]="Harald Fairhair"
#cb4-3  ["Harald Fairhair"]="Halfdan the Black"
#cb4-4  ["Halfdan the Black"]="Gudrød the Hunter"
#cb4-5  ["Gudrød the Hunter"]="Halfdan the Mild"
#cb4-6)
#cb4-7
#cb4-8# shellcheck disable=SC2302,SC2303
#cb4-9for i in "${fatherOf[@]}" 
#cb4-10do
#cb4-11  echo "${fatherOf[$i]:-(missing)} begat $i"
#cb4-12done
```

### Related resources:

- Help by adding links to BashFAQ, StackOverflow, man pages, POSIX, etc!

[ShellCheck](https://www.shellcheck.net) is a static analysis tool for shell scripts. This page is part of its documentation.

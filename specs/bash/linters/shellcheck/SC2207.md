ShellCheck: SC2207 – Prefer `mapfile` or `read -a` to split command output (or quote to avoid splitting).

# SC2207 – ShellCheck Wiki

[See this page on GitHub](https://github.com/koalaman/shellcheck/wiki/SC2207)

[Sitemap](index.html)

## Prefer `mapfile` or `read -a` to split command output (or quote to avoid splitting).

### Problematic code:

```
#cb1-1array=( $(mycommand) )
```

### Correct code:

If it outputs multiple lines, each of which should be an element:

```
#cb2-1# For bash 4.4+, must not be in posix mode, may use temporary files
#cb2-2mapfile -t array < <(mycommand)
#cb2-3
#cb2-4# For bash 3.x+, must not be in posix mode, may use temporary files
#cb2-5array=()
#cb2-6while IFS='' read -r line; do array+=("$line"); done < <(mycommand)
#cb2-7
#cb2-8# For ksh, and bash 4.2+ with the lastpipe option enabled (may require disabling monitor mode)
#cb2-9array=()
#cb2-10mycommand | while IFS="" read -r line; do array+=("$line"); done
```

If it outputs a line with multiple words (separated by spaces, other delimiters can be chosen with IFS), each of which should be an element:

```
#cb3-1# For bash, uses temporary files
#cb3-2IFS=" " read -r -a array <<< "$(mycommand)"
#cb3-3
#cb3-4# For bash 4.2+ with the lastpipe option enabled (may require disabling monitor mode)
#cb3-5array=()
#cb3-6mycommand | IFS=" " read -r -a array
#cb3-7
#cb3-8# For ksh
#cb3-9IFS=" " read -r -A array <<< "$(mycommand)"
```

If the output should be a single element:

```
#cb4-1array=( "$(mycommand)" )
```

### Rationale:

You are doing unquoted command expansion in an array. This will invoke the shell's sloppy word splitting and glob expansion.

Instead, prefer explicitly splitting (or not splitting):

- If you want to split the output into lines or words, use `mapfile`, `read -ra` and/or `while` loops as appropriate.
- If the command output should become a single array element, quote it.

This prevents the shell from doing unwanted splitting and glob expansion, and therefore avoiding problems with output containing spaces or special characters.

### Exceptions:

If you have already taken care (through setting IFS and `set -f`) to have word splitting work the way you intend, you can ignore this warning.

Another exception is the wish for error handling: `array=( $(mycommand) ) || die-with-error` works the way it looks while a similar `mapfile` construct like `mapfile -t array < <(mycommand)`doesn't fail and you will have to write more code for error handling.

[ShellCheck](https://www.shellcheck.net) is a static analysis tool for shell scripts. This page is part of its documentation.

ShellCheck: SC2009 – Consider using `pgrep` instead of grepping `ps` output.

# SC2009 – ShellCheck Wiki

[See this page on GitHub](https://github.com/koalaman/shellcheck/wiki/SC2009)

[Sitemap](index.html)

## Consider using `pgrep` instead of grepping `ps` output.

### Problematic Code:

```
#cb1-1ps ax | grep -v grep | grep "$service" > /dev/null
```

### Correct Code:

```
#cb2-1pgrep -f "$service" > /dev/null
```

### Rationale:

If you are just after a pid from a running program, then pgrep is a much safer alternative. Especially if you are also looking for a pid belonging to a certain user or group. All of the parameters are in one command and it can eliminate multiple greps, cuts, seds, awks, etc.

If you want a field that's not the pid, consider doing this through `ps` + `pgrep` instead of `ps` + `grep`:

```
#cb3-1for pid in $(pgrep '^python$')
#cb3-2do
#cb3-3  user=$(ps -o user= -p "$pid")
#cb3-4  echo "The process $pid is run by $user"
#cb3-5done
```

This is more robust than `ps .. | grep python | cut ..` because it does not try to match against unrelated fields, such as if the user's name was `pythonguru`.

### Exceptions

`pgrep` is not POSIX. Please [ignore](ignore) this warning if you are targeting POSIX userlands.

You can [ignore](ignore) this error if you are trying to match against something that `pgrep` doesn't support:

```
#cb4-1# pgrep does not support filtering by 'nice' value
#cb4-2# shellcheck disable=SC2009
#cb4-3ps -axo nice=,pid= | grep -v '^  0'
```

[ShellCheck](https://www.shellcheck.net) is a static analysis tool for shell scripts. This page is part of its documentation.

ShellCheck: SC2230 – `which` is non-standard. Use builtin `command -v` instead.

# SC2230 – ShellCheck Wiki

[See this page on GitHub](https://github.com/koalaman/shellcheck/wiki/SC2230)

[Sitemap](index.html)

## `which` is non-standard. Use builtin `command -v` instead.

### Optional - `deprecate-which`

This is an [optional](optional) rule, which means that it has a special "long name" and is not enabled by default. See the [optional](optional) page for more details. In short, you have to enable it with the long name instead of the "SC" code like you would with a normal rule:

#### `.shellcheckrc`

```
enable=deprecate-which # SC2230
```

### Problematic code:

```
#cb2-1which grep
```

### Correct code:

```
#cb3-1# For the path of a single, unaliased, external command,
#cb3-2# or to check whether this will just "run" in this shell:
#cb3-3command -v grep
#cb3-4# To check whether commands exist, without obtaining a reusable path:
#cb3-5hash grep
```

### Rationale:

`which` is a non-standard, external tool that locates an executable in PATH. `command -v` is a POSIX standard builtin, which uses the same lookup mechanism that the shell itself would.

### Exceptions:

This check is opt-in only in 0.7.1+, and you may choose to [ignore](ignore) it in earlier versions. `which` is very common, and some prefer its executable-or-nothing behavior over `command -v`'s handling of builtins, functions and aliases.

### Caveats:

#### `command -v` does not check ALL parameters

`command -v` succeeds (with exit code 0) if any command exists:

```
# grep is in /usr/bin/grep
# foobar is not in path
#
$ command -v -- grep foobar; echo $?
0
```

In the above example, it should have failed and exited with 1 unless all commands exist, if it were to be a replacement for `which`. Other problems associated with `command` include its inclusion of builtins, aliases, and functions.

An alternative is:

```
$ hash <file1> <file2>
```

Which observes the standard behaviour of failures.

To obtain a path, `type -p` can be used instead. Like `command -v`, it has a similarly quirky behavior with builtins, aliases, and functions, although this is arguably milder since it would print nothing for these cases. The failure condition is similar to `hash`.

### Related resources:

- `shellcheck` issue: [#1162 command
-v is not a direct replacement for which](https://github.com/koalaman/shellcheck/issues/1162) (Discussion)
- [Check if a
program exists from a Bash script](https://stackoverflow.com/a/677212/1899640) on StackOverflow.

[ShellCheck](https://www.shellcheck.net) is a static analysis tool for shell scripts. This page is part of its documentation.

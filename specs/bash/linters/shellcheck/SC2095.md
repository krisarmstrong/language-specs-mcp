ShellCheck: SC2095 – Use `ssh -n` to prevent ssh from swallowing stdin.

# SC2095 – ShellCheck Wiki

[See this page on GitHub](https://github.com/koalaman/shellcheck/wiki/SC2095)

[Sitemap](index.html)

## Use `ssh -n` to prevent ssh from swallowing stdin.

The same error applies to multiple commands, like `ffmpeg -nostdin` and `mplayer -noconsolecontrols`.

### Problematic code:

```
#cb1-1while read -r host
#cb1-2do
#cb1-3  ssh "$host" "uptime"
#cb1-4done < hosts.txt
```

### Correct code:

```
#cb2-1while read -r host
#cb2-2do
#cb2-3  ssh -n "$host" "uptime"
#cb2-4done < hosts.txt
```

or

```
#cb3-1while read -r host
#cb3-2do
#cb3-3  ssh "$host" <<'EOF'
#cb3-4uptime
#cb3-5EOF
#cb3-6done < hosts.txt
```

or

By using a pipe and avoiding the use of the stdin file descriptor, this ensures that commands in the loop are not interfered with.

```
#cb4-1exec 3< hosts.txt
#cb4-2while read -r host
#cb4-3do
#cb4-4  ssh "$host" "uptime"
#cb4-5done <&3
#cb4-6# Close the file descriptor
#cb4-7exec 3<&-
```

### Rationale:

Commands that process stdin will compete with the `read` statement for input. This is especially tricky for commands you wouldn't expect reads from stdin, like `ssh .. uptime`, `ffmpeg` and `mplayer`.

The most common symptom of this is a `while read` loop only running once, even though the input contains many lines. This is because the rest of the lines are swallowed by the offending command.

To refuse such commands input, you can use a command specific option like `ssh -n` or `ffmpeg -nostdin`.

More generally, you can also redirect their stdin with `< /dev/null`. This works for all commands with this behavior.

### Exceptions:

None.

### Related resources:

- [BashFaq: I'm
reading a file line by line and running ssh or ffmpeg, only the first
line gets processed!](https://mywiki.wooledge.org/BashFAQ/089)
- [StackOverflow:
Shell script while read line loop stops after the first line](https://stackoverflow.com/questions/13800225/shell-script-while-read-line-loop-stops-after-the-first-line)

[ShellCheck](https://www.shellcheck.net) is a static analysis tool for shell scripts. This page is part of its documentation.

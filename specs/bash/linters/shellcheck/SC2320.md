ShellCheck: SC2320 – This `$?` refers to echo/printf, not a previous command. Assign to variable to avoid it being overwritten.

# SC2320 – ShellCheck Wiki

[See this page on GitHub](https://github.com/koalaman/shellcheck/wiki/SC2320)

[Sitemap](index.html)

## This `$?` refers to echo/printf, not a previous command. Assign to variable to avoid it being overwritten.

### Problematic code:

```
#cb1-1mycommand
#cb1-2echo "Command exited with $?"
#cb1-3if [ $? -ne 0 ]
#cb1-4then
#cb1-5  echo "Failed"
#cb1-6fi
```

### Correct code:

```
#cb2-1mycommand
#cb2-2ret=$?
#cb2-3echo "Command exited with $ret"
#cb2-4if [ $ret -ne 0 ]
#cb2-5then
#cb2-6  echo "Failed"
#cb2-7fi
```

### Rationale:

ShellCheck found a `$?` that always refers to `echo` or `printf`.

This most commonly happens when trying to show `$?` before doing something with it, without realizing that any such action will also overwrite `$?`.

In the problematic example, `echo "Command exited with $?"` was intended to show the exit code before acting on it, but the act of showing `$?` also overwrote it, so the condition is always false. The solution is to assign `$?` to a variable first, so that it can be used repeatedly.

### Exceptions:

If you intentionally refer to `echo` to get the result of a write, you can ignore this message. Alternatively, write it out as in `if echo $$ > "$pidfile"; then status=0; else status=1; fi`

### Related resources:

- Help by adding links to BashFAQ, StackOverflow, man pages, POSIX, etc!

[ShellCheck](https://www.shellcheck.net) is a static analysis tool for shell scripts. This page is part of its documentation.

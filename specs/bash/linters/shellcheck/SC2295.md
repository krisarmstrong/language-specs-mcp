ShellCheck: SC2295 – Expansions inside `${..}` need to be quoted separately, otherwise they will match as a pattern.

# SC2295 – ShellCheck Wiki

[See this page on GitHub](https://github.com/koalaman/shellcheck/wiki/SC2295)

[Sitemap](index.html)

## Expansions inside `${..}` need to be quoted separately, otherwise they will match as a pattern.

### Problematic code:

```
#cb1-1relative_path() {
#cb1-2  printf '%s\n' "${2#$1}"
#cb1-3}
#cb1-4
#cb1-5# Results in "/tmp/King_Kong_[1933]/extras/trailer.mkv" because the prefix fails to match
#cb1-6relative_path "/tmp/King_Kong_[1933]/" "/tmp/King_Kong_[1933]/extras/trailer.mkv"
#cb1-7
#cb1-8# Results in "cover.jpg" even though the prefix is different
#cb1-9relative_path "/tmp/King_Kong_[1933]/" "/tmp/King_Kong_3/cover.jpg"
```

### Correct code:

```
#cb2-1relative_path() {
#cb2-2  printf '%s\n' "${2#"$1"}"
#cb2-3}
#cb2-4# Results in "extras/trailer.mkv" as expected
#cb2-5relative_path "/tmp/King_Kong_[1933]/" "/tmp/King_Kong_[1933]/extras/trailer.mkv"
#cb2-6
#cb2-7# Results in "/tmp/King_Kong_3/cover.jpg" as expected
#cb2-8relative_path "/tmp/King_Kong_[1933]/" "/tmp/King_Kong_3/cover.jpg"
```

### Rationale:

When using expansions in a parameter expansion prefix/suffix expression, the expansion needs to be quoted separately or it will match as a pattern. The quotes around the outer parameter expansion do not protect against this.

This means that any variable that contains e.g. brackets, asterisks or question marks may not match as expected. In the example, `[1933]` was interpreted as a pattern character range and would therefore match `/tmp/King_Kong_3/` but not `/tmp/King_Kong_[1933]/` as was the intention.

### Exceptions:

If you wanted to treat the string as a pattern, such as `suffix=".*"; file="${var%$suffix}";` then you can [ignore](ignore) this suggestion.

### Related resources:

- Help by adding links to BashFAQ, StackOverflow, man pages, POSIX, etc!

[ShellCheck](https://www.shellcheck.net) is a static analysis tool for shell scripts. This page is part of its documentation.

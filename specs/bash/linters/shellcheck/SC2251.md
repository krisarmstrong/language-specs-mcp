ShellCheck: SC2251 – This `!` is not on a condition and skips errexit. Add `|| exit 1` or make sure `$?` is checked.

# SC2251 – ShellCheck Wiki

[See this page on GitHub](https://github.com/koalaman/shellcheck/wiki/SC2251)

[Sitemap](index.html)

## This `!` is not on a condition and skips errexit. Add `|| exit 1` or make sure `$?` is checked.

### Problematic code:

```
#cb1-1set -e
#cb1-2! false
#cb1-3rest
```

### Correct code:

```
#cb2-1set -e
#cb2-2! false || exit 1
```

### Rationale:

ShellCheck has found a command inverted with `!` that may have no effect. In particular, it does not appear as a condition in an `if` statement or `while` loop, or as the final command in a script or function.

The most common reason for this is thinking that it'll trigger `set -e` aka `errexit` if a command succeeds, as in the example. This is not the case: `!` will inhibit errexit both on success and failure of the inverted command.

Adding `|| exit` will instead exit with failure when the command succeeds.

### Exceptions:

ShellCheck will not detect cases where `$?` is implicitly or explicitly used to check the value afterwards:

```
#cb3-1set -e
#cb3-2check_success() { [ $? -eq 0 ] || exit 1; }
#cb3-3! false; check_success
#cb3-4! true; check_success
```

In this case, you can [ignore](ignore) the warning.

### Related resources:

- StackOverflow: [Why
do I need parenthesis In bash set -e and negated return
code](https://stackoverflow.com/questions/39581150/why-do-i-need-parenthesis-in-bash-set-e-and-negated-return-code/39582012)
- [The
"Use && exit 1" for SC2251 can result in a wrong exit
code](https://github.com/koalaman/shellcheck/issues/3121)

[ShellCheck](https://www.shellcheck.net) is a static analysis tool for shell scripts. This page is part of its documentation.
